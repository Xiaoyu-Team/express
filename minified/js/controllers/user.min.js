var User=require("../models/user.js");exports.signup=function(e,n){var r=e.body;User.find({name:r.name},function(e,o){if(e&&console.log(e),o.length)return n.redirect("/");var s=new User(r);s.save(function(e,r){e&&console.log(e),n.redirect("/")})})},exports.signin=function(e,n){var r=e.body,o=r.name,s=r.password;User.findOne({name:o},function(r,o){return r&&console.log(r),o?void User.comparPassword(s,function(r,s){return r&&console.log(r),s?(e.session.user=o,n.redirect("/")):void console.log(" password is not matched ")}):n.redirect("/signup")})},exports.logout=function(e,n){delete e.session.user,n.redirect("/")},exports.showSignup=function(e,n){n.render("signup",{title:"注册页面"})},exports.showSignin=function(e,n){n.render("signup",{title:"登录页面"})},exports.signinRequired=function(e,n,r){var o=e.session.user;return o?void r():n.redirect("/signin")},exports.adminRequired=function(e,n,r){var o=e.session.user;return o.role<=10?n.redirect("/"):void r()};